{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="container my-4">

    {# --- Preview of the Post Being Viewed --- #}
    <div class="row justify-content-center mb-4">
      
        <div class="card p-3" style="width: 20rem">
          {% if tweet.image %}
            <img
              src="{{ tweet.image.url }}"
              class="card-img-top rounded"
              style="height: 200px; object-fit: cover"
              alt="Tweet image"
            />
          {% endif %}
          <div class="card-body text-center">
            <h5 class="card-title">{{ tweet.user.username }}</h5>
            <p class="card-text">{{ tweet.content }}</p>
            <small class="text-muted">
              Posted on {{ tweet.created_at|date:"Y-m-d H:i" }}
            </small>
          </div>
        </div>
      
    </div>

    {# --- Mobile: Likes Dropdown --- #}
    <div class="d-lg-none row justify-content-center mb-3">
      <div class="col-auto text-center">
        <button
          class="btn btn-outline-secondary"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#likesCollapse"
          aria-expanded="false"
          aria-controls="likesCollapse"
        >
          üëç Likes ({{ likers|length }})
        </button>
        <div class="collapse mt-2" id="likesCollapse">
          <ul class="list-group">
            {% for username in likers %}
              <li class="list-group-item">{{ username }}</li>
            {% empty %}
              <li class="list-group-item text-muted">No likes yet</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    {# --- Desktop & Tablet: Comments & Likes Side-by-Side --- #}
    <div class="row justify-content-center">
      {# Comments Column #}
      <div class="col-12 col-lg-8 mb-4">
        <div class="card">
          <div class="card-header text-center">
            Comments ({{ comments|length }})
          </div>
          <ul class="list-group list-group-flush">
            {% for c in comments %}
              <li class="list-group-item">
                <div class="d-flex justify-content-between align-items-center">
                  <strong>{{ c.user.username }}</strong>
                  <small class="text-muted">
                    {{ c.created_at|date:"Y-m-d H:i" }}
                  </small>
                </div>
                <p class="mb-0">{{ c.content }}</p>
              </li>
            {% empty %}
              <li class="list-group-item text-center text-muted">
                No comments yet
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>

      {# Likes Column (visible ‚â• lg) #}
      <div class="d-none d-lg-block col-lg-4 mb-4">
        <div class="card">
          <div class="card-header text-center">
            üëç Likes ({{ likers|length }})
          </div>
          <ul class="list-group list-group-flush">
            {% for username in likers %}
              <li class="list-group-item">{{ username }}</li>
            {% empty %}
              <li class="list-group-item text-muted">No likes yet</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_js %}
  {# Bootstrap JS for collapse functionality #}
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pPRp+Yk68jniXZ1aHDzJ6kbqnSA3tEw8jjZC1eFHbq/4p1gE/4hw3WsU5QonulpX"
    crossorigin="anonymous"
  ></script>
{% endblock %}
